<% layout("layouts/boilerplate") %>

<div class="show-container">
       
 <!-- // =============================== -->
<!-- // for right side of card -->
<!-- // =============================== -->

  <div class="show-img-box show-left">
      <img src="<%= listing.image.url %>" class="show-img" alt="image">
  </div>

    <div class="greeting-box show-right ">
<h2>
    Hey 
    <span><%= curruser ? curruser.username : "Guest" %></span>! ğŸ‘‹
</h2>
    
    <p class="greet-sub">Here are some quick highlights of the property:</p>
   <p><i class="bi bi-star-fill"></i> Top Rated Property</p>

        <p><i class="bi bi-geo-alt-fill"></i> Located in <strong><%= listing.location %></strong></p>

        <p><i class="bi bi-cash-stack"></i> Price: â‚¹ <%= listing.price %> / night</p>

        <p><i class="bi bi-house-heart-fill"></i> ComfortKey Verified</p>
       <p><i class="bi bi-person-fill"> </i>Owned by<span><b><%= listing.owner.username %></b></span></p>

  </div>


<!-- // =============================== -->
<!-- // for details and description-->
<!-- // =============================== -->

  <div class="right-card">

      <!-- DETAILS SECTION -->
      <div class="show-content">


          <h2 class="show-title"><%= listing.title %></h2>


          <p class="show-rating">â­ 4.6 â€¢ Excellent Stay</p>

          <p class="show-location">
            ğŸ“ <%= listing.location %>, <%= listing.country %>
          </p>

<p class="show-price">
  â‚¹ <%= listing.price ? listing.price.toLocaleString("en-IN") : "N/A" %> / night
</p>


          <div class="show-description">
            <h4>About this place</h4>
            <p><%= listing.description %></p>
          </div>

          <div class="show-details">
            <p>ğŸ›ï¸ <strong>Room Type:</strong> Comfortable Private Room</p>
            <p>ğŸ•’ <strong>Check-In:</strong> 12:00 PM</p>
            <p>ğŸšª <strong>Check-Out:</strong> 11:00 AM</p>
            <p>ğŸ‘¤ <strong>Host:</strong> TheComfortKey Team</p>
          </div>

          <div class="show-amenities">
            <h4>Amenities</h4>
            <ul>
              <li>âœ¨ Free WiFi</li>
              <li>ğŸŒ¡ï¸ AC Room</li>
              <li>ğŸ³ Breakfast Available</li>
              <li>ğŸ› Clean Bathroom</li>
            </ul>
          </div>

        


          <!-- // =============================== -->
<!-- // buttons -->
<!-- // =============================== -->

          <div class="show-buttons">
            <!-- to hide the button for whos not the owner -->
            <% if (curruser && curruser._id.equals(listing.owner._id)) { %>

            <a href="/listings/<%= listing._id %>/edit" class="pink-btn  own">Edit</a>

            <form action="/listings/<%= listing._id %>?_method=DELETE" method="POST" class="inline-delete">
              <button class="delete-btn">Delete</button>
            </form>

            <% } %>

            <a href="/listings/<%= listing._id %>/booknow" class="pink-btn">Book Now</a>
          </div>

      </div> <!-- END DETAILS -->




      <!-- // =============================== -->
     <!-- // review and comment section -->
     <!-- // =============================== -->

      <div class="col-8 offset-3 review-section">

        <h4>Leave a Review</h4>
        <p class="review-helper">Share your experience with future guests.</p>

       <form action="/listings/<%= listing._id %>/reviews" 
      method="POST"  
      novalidate 
      class="needs-validation">



  <!-- RATING DROPDOWN -->
 <!-- â­ EMOJI RATING INPUT -->
<div class="rating-box emoji-rating">
 


  <legend class="rating-legend">How was your stay?</legend>

 <fieldset class="starability-slot">
  


  <input type="radio" id="no-rate" class="input-no-rate" name="review[rating]" value="1" checked aria-label="No rating." />
  <input type="radio" id="first-rate1" name="review[rating]" value="1" />
  <label for="first-rate1" title="Terrible">1 star</label>
  <input type="radio" id="first-rate2" name="review[rating]" value="2" />
  <label for="first-rate2" title="Not good">2 stars</label>
  <input type="radio" id="first-rate3" name="review[rating]" value="3" />
  <label for="first-rate3" title="Average">3 stars</label>
  <input type="radio" id="first-rate4" name="review[rating]" value="4" />
  <label for="first-rate4" title="Very good">4 stars</label>
  <input type="radio" id="first-rate5" name="review[rating]" value="5" />
  <label for="first-rate5" title="Amazing">5 stars</label>
</fieldset>


 
</div>


 <!-- // =============================== -->
<!-- // comments -->
<!-- // =============================== -->

  <div class="review-input mb-3">
    <label for="comments">Comment</label>
    <textarea name="review[comment]" 
              id="comments" 
              class="form-control"
              required></textarea>

    <div class="invalid-feedback">
      Please enter a comment.
    </div>
  </div>

  <button class="pink-btn submit-review-btn">Submit</button>

</form>
<hr>

<h4>All Reviews</h4>

<!-- for all reviews and for deleting of reviews -->

<div class="tk-wrap-review-container">
  <% for (let review of listing.reviews) { %>

    <div class="tk-wrap-review-card  ms-3 mb-3">

      <div class="tk-rev">

        <p class="tk-wrap-review-text user-rev">
    <i class="bi bi-person-circle"></i>
   <strong><%= review.author ? review.author.username : "Unknown" %></strong>

</p>
   
  <p class="starability-result" data-rating="<%= review.rating %>">
  Rated: <%= review.rating %> stars
</p>

      </div>

      <p class="tk-wrap-review-text"><%= review.comment %></p>
      <form  method ="POST" action ="/listings/<%= listing._id %>/reviews/<%= review._id %>?_method=DELETE">
  <button class="delete-icon-clean " type="submit" aria-label="Delete">

    <!-- for hiding delete button for any other user -->
    <% if (curruser && review.author && curruser._id.equals(review.author._id)) { %>
    <i class="bi bi-trash-fill icon" aria-hidden="true"></i>
<% } %>

  </button>
</form>

    </div>

  <% } %>
  
</div>





      </div>

  </div> <!-- END RIGHT CARD -->

</div> <!-- END SHOW CONTAINER -->
